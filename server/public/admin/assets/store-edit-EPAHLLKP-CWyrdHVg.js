import{u as g}from"./chunk-3TZOFKX2-BCNjwtJm.js";import{C as b}from"./chunk-OFN7DIZA-Bai-TcOq.js";import{K as D}from"./chunk-6HTZNHPT-vT0uWT2U.js";import{R as _}from"./chunk-XXBP2Z5M-BarMMowL.js";import{u as R}from"./chunk-42OOM4DJ-BolCKpuN.js";import{b as q,v as k,j as e,H as M,d as N,z as B,aD as H,aE as O,ax as A,f5 as P,t as E,J as o,K as U,aw as d,B as I,az as u,s as C}from"./index-COdTnWJD.js";var J=A({name:u().min(1),default_currency_code:u().optional(),default_locale_code:u().optional(),default_region_id:u().optional(),default_sales_channel_id:u().optional(),default_location_id:u().optional()}),$=({store:l})=>{var y,v,V,S;const{t:s}=q(),p=N("translation"),{handleSuccess:j}=R(),h=B(),r=H({defaultValues:{name:l.name,default_region_id:l.default_region_id||void 0,default_locale_code:((v=(y=l.supported_locales)==null?void 0:y.find(a=>a.is_default))==null?void 0:v.locale_code)||void 0,default_currency_code:((S=(V=l.supported_currencies)==null?void 0:V.find(a=>a.is_default))==null?void 0:S.currency_code)||void 0,default_sales_channel_id:l.default_sales_channel_id||void 0,default_location_id:l.default_location_id||void 0},resolver:O(J)}),{mutateAsync:w,isPending:K}=P(l.id),m=g({queryKey:["regions","default_region_id"],queryFn:a=>C.admin.region.list({...a,fields:"id,name"}),defaultValue:l.default_region_id||void 0,getOptions:a=>a.regions.map(n=>({label:n.name,value:n.id}))}),f=g({queryFn:a=>C.admin.salesChannel.list({...a,fields:"id,name"}),getOptions:a=>a.sales_channels.map(n=>({label:n.name,value:n.id})),queryKey:["sales_channels","default_sales_channel_id"],defaultValue:l.default_sales_channel_id||void 0}),x=g({queryFn:a=>C.admin.stockLocation.list({...a,fields:"id,name"}),getOptions:a=>a.stock_locations.map(n=>({label:n.name,value:n.id})),queryKey:["stock_locations","default_location_id"],defaultValue:l.default_location_id||void 0}),T=r.handleSubmit(async a=>{var F,L;const{default_currency_code:n,default_locale_code:i,...t}=a,z={...t,supported_locales:(F=l.supported_locales)==null?void 0:F.map(c=>({...c,is_default:c.locale_code===i})),supported_currencies:(L=l.supported_currencies)==null?void 0:L.map(c=>({...c,is_default:c.currency_code===n}))};await w(z,{onSuccess:()=>{E.success(s("store.toast.update")),j()},onError:c=>{E.error(c.message)}})});return e.jsx(_.Form,{form:r,children:e.jsxs(D,{onSubmit:T,className:"flex h-full flex-col overflow-hidden",children:[e.jsx(_.Body,{className:"overflow-y-auto",children:e.jsxs("div",{className:"flex flex-col gap-y-8",children:[e.jsx(o.Field,{control:r.control,name:"name",render:({field:a})=>e.jsxs(o.Item,{children:[e.jsx(o.Label,{children:s("fields.name")}),e.jsx(o.Control,{children:e.jsx(U,{placeholder:"ACME",...a})}),e.jsx(o.ErrorMessage,{})]})}),e.jsx(o.Field,{control:r.control,name:"default_currency_code",render:({field:{onChange:a,...n}})=>{var i;return e.jsxs(o.Item,{children:[e.jsx(o.Label,{children:s("store.defaultCurrency")}),e.jsx(o.Control,{children:e.jsxs(d,{dir:h,...n,onValueChange:a,children:[e.jsx(d.Trigger,{ref:n.ref,children:e.jsx(d.Value,{})}),e.jsx(d.Content,{children:(i=l.supported_currencies)==null?void 0:i.map(t=>e.jsx(d.Item,{value:t.currency_code,children:t.currency_code.toUpperCase()},t.currency_code))})]})})]})}}),p&&e.jsx(o.Field,{control:r.control,name:"default_locale_code",render:({field:{onChange:a,...n}})=>{var i;return e.jsxs(o.Item,{children:[e.jsx(o.Label,{children:s("store.defaultLocale")}),e.jsx(o.Control,{children:e.jsxs(d,{dir:h,...n,onValueChange:a,children:[e.jsx(d.Trigger,{ref:n.ref,children:e.jsx(d.Value,{})}),e.jsx(d.Content,{children:(i=l.supported_locales)==null?void 0:i.map(t=>e.jsx(d.Item,{value:t.locale_code,children:t.locale_code},t.locale_code))})]})})]})}}),e.jsx(o.Field,{control:r.control,name:"default_region_id",render:({field:a})=>e.jsxs(o.Item,{children:[e.jsx(o.Label,{children:s("store.defaultRegion")}),e.jsx(o.Control,{children:e.jsx(b,{...a,options:m.options,searchValue:m.searchValue,onSearchValueChange:m.onSearchValueChange,disabled:m.disabled})})]})}),e.jsx(o.Field,{control:r.control,name:"default_sales_channel_id",render:({field:a})=>e.jsxs(o.Item,{children:[e.jsx(o.Label,{children:s("store.defaultSalesChannel")}),e.jsx(o.Control,{children:e.jsx(b,{...a,options:f.options,searchValue:f.searchValue,onSearchValueChange:f.onSearchValueChange,disabled:f.disabled})})]})}),e.jsx(o.Field,{control:r.control,name:"default_location_id",render:({field:a})=>e.jsxs(o.Item,{children:[e.jsx(o.Label,{children:s("store.defaultLocation")}),e.jsx(o.Control,{children:e.jsx(b,{...a,options:x.options,searchValue:x.searchValue,onSearchValueChange:x.onSearchValueChange,disabled:x.disabled})})]})})]})}),e.jsx(_.Footer,{children:e.jsxs("div",{className:"flex items-center justify-end gap-x-2",children:[e.jsx(_.Close,{asChild:!0,children:e.jsx(I,{size:"small",variant:"secondary",children:s("actions.cancel")})}),e.jsx(I,{size:"small",isLoading:K,type:"submit",children:s("actions.save")})]})})]})})},ee=()=>{const{t:l}=q(),{store:s,isPending:p,isError:j,error:h}=k();if(j)throw h;const r=!!s&&!p;return e.jsxs(_,{children:[e.jsx(_.Header,{children:e.jsx(M,{children:l("store.edit.header")})}),r&&e.jsx($,{store:s})]})};export{ee as Component};
