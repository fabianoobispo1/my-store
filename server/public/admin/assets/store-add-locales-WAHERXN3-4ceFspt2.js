import{u as N,a as B}from"./chunk-XNIVMZHA-7G_7qry_.js";import{d as H,u as M,v as K,j as e,b as P,f6 as O,aD as U,aE as V,ax as q,r as R,f5 as G,t as v,a2 as Q,B as w,aI as X,az as Z,g as $,al as J,a3 as C,k as W}from"./index-COdTnWJD.js";import{u as Y,_ as ee}from"./chunk-YTN73JYH-CUJ2QIAI.js";import"./chunk-GU5PJRPM-Du_6H0D9.js";import{K as se}from"./chunk-6HTZNHPT-vT0uWT2U.js";import{R as d,u as ae}from"./chunk-42OOM4DJ-BolCKpuN.js";import"./chunk-MSDRGCRR-KYQ-t3VP.js";import"./chunk-P3UUX2T6-K6AGHv25.js";import"./chunk-C76H5USB-B0s8aZMb.js";import"./chunk-HQKGZADC-CAHP7YxT.js";import"./chunk-EMIHDNB7-LC-ycJ86.js";import"./chunk-DZWH2RV6-Db7ViQ77.js";import"./index-C_3Mvj6f.js";var oe=q({locales:X(Z()).min(1)}),f=50,h="al",te=({store:r})=>{var j;const{t:o}=P(),{handleSuccess:s}=ae(),{raw:t,searchParams:u}=N({pageSize:f,prefix:h}),{locales:n,count:l,isPending:k,isError:_,error:A}=O(u,{placeholderData:W}),m=U({defaultValues:{locales:[]},resolver:V(oe)}),[x,E]=R.useState({}),{setValue:T}=m,F=a=>{const c=typeof a=="function"?a(x):a,p=Object.keys(c);T("locales",p,{shouldDirty:!0,shouldTouch:!0}),E(c)},g=((j=r.supported_locales)==null?void 0:j.map(a=>a.locale_code))??[],S=le(),{table:L}=Y({data:n??[],columns:S,count:l,getRowId:a=>a.code,enableRowSelection:a=>!g.includes(a.original.code),enablePagination:!0,pageSize:f,prefix:h,rowSelection:{state:x,updater:F}}),{mutateAsync:I,isPending:z}=G(r.id),D=m.handleSubmit(async a=>{var y,b;const c=Array.from(new Set([...a.locales,...g]));let p=(b=(y=r.supported_locales)==null?void 0:y.find(i=>i.is_default))==null?void 0:b.locale_code;c.includes(p??"")||(p=c==null?void 0:c[0]),await I({supported_locales:c.map(i=>({locale_code:i,is_default:i===p}))},{onSuccess:()=>{v.success(o("store.toast.localesUpdated")),s()},onError:i=>{v.error(i.message)}})});if(_)throw A;return e.jsx(d.Form,{form:m,children:e.jsxs(se,{onSubmit:D,className:"flex h-full flex-col overflow-hidden",children:[e.jsx(d.Header,{children:e.jsx("div",{className:"flex flex-1 items-center justify-between",children:e.jsx("div",{className:"flex items-center",children:m.formState.errors.locales&&e.jsx(Q,{variant:"error",children:m.formState.errors.locales.message})})})}),e.jsx(d.Body,{className:"flex flex-1 flex-col overflow-hidden",children:e.jsx(ee,{table:L,pageSize:f,count:l,columns:S,layout:"fill",pagination:!0,search:"autofocus",prefix:h,orderBy:[{key:"name",label:o("fields.name")},{key:"code",label:o("fields.code")}],isLoading:k,queryObject:t})}),e.jsx(d.Footer,{children:e.jsxs("div",{className:"flex items-center justify-end gap-x-2",children:[e.jsx(d.Close,{asChild:!0,children:e.jsx(w,{size:"small",variant:"secondary",children:o("actions.cancel")})}),e.jsx(w,{size:"small",type:"submit",isLoading:z,children:o("actions.save")})]})})]})})},re=$(),le=()=>{const{t:r}=P(),o=B();return R.useMemo(()=>[re.display({id:"select",header:({table:s})=>e.jsx(C,{checked:s.getIsSomePageRowsSelected()?"indeterminate":s.getIsAllPageRowsSelected(),onCheckedChange:t=>s.toggleAllPageRowsSelected(!!t)}),cell:({row:s})=>{const t=!s.getCanSelect(),u=s.getIsSelected()||t,n=e.jsx(C,{checked:u,disabled:t,onCheckedChange:l=>s.toggleSelected(!!l),onClick:l=>{l.stopPropagation()}});return t?e.jsx(J,{content:r("store.localeAlreadyAdded"),side:"right",children:n}):n}}),...o],[r,o])},ye=()=>{const r=H("translation"),o=M();if(!r)return o(-1),null;const{store:s,isPending:t,isError:u,error:n}=K(),l=!!s&&!t;if(u)throw n;return e.jsx(d,{children:l&&e.jsx(te,{store:s})})};export{ye as Component};
