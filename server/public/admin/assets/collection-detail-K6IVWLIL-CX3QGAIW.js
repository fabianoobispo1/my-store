import{u as _}from"./chunk-BW322BVH-DNBqSDGl.js";import{e as q,ag as I,ei as b,a as z,j as a,ej as M,s as B,ek as H,q as L,b as p,h as g,u as O,eg as Q,C as f,H as S,A as x,P as C,T as P,a4 as j,f as W,el as w,an as Y,r as $,g as F,a3 as v,k as G,t as d}from"./index-COdTnWJD.js";import{u as J,_ as K}from"./chunk-YTN73JYH-CUJ2QIAI.js";import{u as U,a as Z}from"./chunk-XTQ7UFA3-BnP2r9rZ.js";import"./chunk-GU5PJRPM-Du_6H0D9.js";import{S as V}from"./chunk-GIZFNLKK-yZY4MngQ.js";import"./chunk-XLDQPLK4-n9r40qsa.js";import"./chunk-ADOCJB6L-BM3WkecS.js";import"./chunk-P3UUX2T6-K6AGHv25.js";import"./chunk-IQBAUTU5-AOiqNbyY.js";import"./chunk-HQKGZADC-CAHP7YxT.js";import"./chunk-EMIHDNB7-LC-ycJ86.js";import"./chunk-C76H5USB-B0s8aZMb.js";import"./chunk-DZWH2RV6-Db7ViQ77.js";import"./index-C_3Mvj6f.js";import"./Trans-BZWDSPrC.js";var fe=s=>{const{id:e}=s.params||{},{collection:t}=b(e,{initialData:s.data,enabled:!!e});return t?a.jsx("span",{children:t.title}):null},X=({collection:s})=>{const{t:e}=p(),t=g(),o=O(),{mutateAsync:i}=Q(s.id),r=async()=>{await t({title:e("general.areYouSure"),description:e("collections.deleteWarning",{count:1,title:s.title})})&&(await i(),o("../",{replace:!0}))};return a.jsxs(f,{className:"divide-y p-0",children:[a.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[a.jsx(S,{children:s.title}),a.jsx(x,{groups:[{actions:[{icon:a.jsx(C,{}),label:e("actions.edit"),to:`/collections/${s.id}/edit`,disabled:!s.id}]},{actions:[{icon:a.jsx(P,{}),label:e("actions.delete"),onClick:r,disabled:!s.id}]}]})]}),a.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-center px-6 py-4",children:[a.jsx(j,{size:"small",leading:"compact",weight:"plus",children:e("fields.handle")}),a.jsxs(j,{size:"small",children:["/",s.handle]})]})]})},l=10,ee=({collection:s})=>{const{t:e}=p(),{searchParams:t,raw:o}=U({pageSize:l}),{products:i,count:r,isLoading:n,isError:u,error:k}=W({limit:l,...t,collection_id:[s.id]},{placeholderData:G}),T=Z(["collections"]),h=se(),{table:D}=J({data:i??[],columns:h,getRowId:c=>c.id,count:r,enablePagination:!0,enableRowSelection:!0,pageSize:l,meta:{collectionId:s.id}}),A=g(),{mutateAsync:R}=w(s.id),E=async c=>{const m=Object.keys(c);await A({title:e("general.areYouSure"),description:e("collections.removeProductsWarning",{count:m.length}),confirmText:e("actions.remove"),cancelText:e("actions.cancel")})&&await R({remove:m},{onSuccess:()=>{d.success(e("collections.products.remove.successToast",{count:m.length}))},onError:N=>{d.error(N.message)}})};if(u)throw k;return a.jsxs(f,{className:"divide-y p-0",children:[a.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[a.jsx(S,{level:"h2",children:e("products.domain")}),a.jsx(x,{groups:[{actions:[{icon:a.jsx(Y,{}),label:e("actions.add"),to:"products"}]}]})]}),a.jsx(K,{table:D,columns:h,search:!0,pagination:!0,pageSize:l,navigateTo:({original:c})=>`/products/${c.id}`,count:r,filters:T,isLoading:n,orderBy:[{key:"title",label:e("fields.title")},{key:"created_at",label:e("fields.createdAt")},{key:"updated_at",label:e("fields.updatedAt")}],queryObject:o,commands:[{action:E,label:e("actions.remove"),shortcut:"r"}],noRecords:{message:e("collections.products.list.noRecordsMessage")}})]})},te=({product:s,collectionId:e})=>{const{t}=p(),o=g(),{mutateAsync:i}=w(e),r=async()=>{await o({title:t("general.areYouSure"),description:t("collections.removeSingleProductWarning",{title:s.title}),confirmText:t("actions.remove"),cancelText:t("actions.cancel")})&&await i({remove:[s.id]},{onSuccess:()=>{d.success(t("collections.products.remove.successToast",{count:1}))},onError:u=>{d.error(u.message)}})};return a.jsx(x,{groups:[{actions:[{icon:a.jsx(C,{}),label:t("actions.edit"),to:`/products/${s.id}/edit`}]},{actions:[{icon:a.jsx(P,{}),label:t("actions.remove"),onClick:r}]}]})},y=F(),se=()=>{const s=_();return $.useMemo(()=>[y.display({id:"select",header:({table:e})=>a.jsx(v,{checked:e.getIsSomePageRowsSelected()?"indeterminate":e.getIsAllPageRowsSelected(),onCheckedChange:t=>e.toggleAllPageRowsSelected(!!t)}),cell:({row:e})=>a.jsx(v,{checked:e.getIsSelected(),onCheckedChange:t=>e.toggleSelected(!!t),onClick:t=>{t.stopPropagation()}})}),...s,y.display({id:"actions",cell:({row:e,table:t})=>{const{collectionId:o}=t.options.meta;return a.jsx(te,{product:e.original,collectionId:o})}})],[s])},Se=()=>{const s=q(),{id:e}=I(),{collection:t,isLoading:o,isError:i,error:r}=b(e,{initialData:s}),{getWidgets:n}=z();if(o||!t)return a.jsx(M,{sections:2,showJSON:!0,showMetadata:!0});if(i)throw r;return a.jsxs(V,{widgets:{after:n("product_collection.details.after"),before:n("product_collection.details.before")},showJSON:!0,showMetadata:!0,data:t,children:[a.jsx(X,{collection:t}),a.jsx(ee,{collection:t})]})},ae=s=>({queryKey:H.detail(s),queryFn:async()=>B.admin.productCollection.retrieve(s)}),Ce=async({params:s})=>{const e=s.id,t=ae(e);return L.ensureQueryData(t)};export{fe as Breadcrumb,Se as Component,Ce as loader};
